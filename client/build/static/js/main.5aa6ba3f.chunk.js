(this["webpackJsonptic-tae-toe"]=this["webpackJsonptic-tae-toe"]||[]).push([[0],{33:function(e,t,n){},35:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var r=n(5),c=n.n(r),o=n(24),a=n.n(o),i=(n(33),n(15)),s=n(19),u=n.n(s),l=n(23),j=n(7),f=(n(35),n(0));function b(e){var t=e.click,n=e.val;e.row,e.col;return Object(f.jsx)("button",{className:"square",onClick:t,children:n})}var O=function(e){var t=e.square,n=e.onClick,r=e.len,c=function(e,c){return Object(f.jsx)(b,{val:t[e][c],click:function(){return n(e,c)},row:e,col:c},e*r+c)};return function(){for(var e=Array(r).fill(0).map((function(e){return new Array(r).fill(0)})),t=0;t<r;t++)for(var n=0;n<r;n++)e[t][n]=t*r+n;return e.map((function(t,n){return Object(f.jsx)("div",{className:"board-row",children:(r=n,e[0].map((function(e,t){return c(r,t)})))},t);var r}))}()},x=Object(r.createContext)(),h=function(e,t,n,r){return function(e,t,n,r){for(var c=0,o=t;n>=0&&n<15&&t-1>=0&&e[t-1][n]===r;)c++,t--;for(;n>=0&&n<15&&o+1<15&&e[o+1][n]===r;)c++,o++;return c}(e,t,n,r)+1>=5||function(e,t,n,r){for(var c=0,o=n;t>=0&&t<15&&n-1>=0&&e[t][n-1]===r;)c++,n--;for(;t>=0&&t<15&&n+1<15&&e[t][o+1]===r;)c++,o++;return c}(e,t,n,r)+1>=5||function(e,t,n,r){for(var c=0,o=t,a=n;o+1<15&&a+1<15&&e[o+1][a+1]===r;)o++,a++,c++;for(;t-1>=0&&n-1>=0&&e[t-1][n-1]===r;)t--,n--,c++;return c}(e,t,n,r)+1>=5||function(e,t,n,r){for(var c=0,o=t,a=n;o-1>=0&&a+1<15&&e[o-1][a+1]===r;)o--,a++,c++;for(;t+1<15&&n-1>=0&&e[t+1][n-1]===r;)t++,n--,c++;return c}(e,t,n,r)+1>=5},m=function(e){var t=e.socket,n=e.username,c=e.room,o=Object(r.useContext)(x),a=Object(i.a)(o,2),s=(a[0],a[1]),b=Object(r.useState)({stepNum:0,xIsNext:!0,history:[{square:Array(15).fill(null).map((function(e){return new Array(15).fill(null)}))}],curX:0,curY:0,isWin:!1,winner:null,room:c}),m=Object(i.a)(b,2),v=m[0],p=m[1];Object(r.useEffect)((function(){t.on("receive_chess",(function(e){console.log(e),p((function(t){return Object(j.a)(Object(j.a)({},t),e)}))}))}),[t]);var d=function(){var e=Object(l.a)(u.a.mark((function e(n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("idx:".concat(n)),r=Object(j.a)(Object(j.a)({},v),{},{stepNum:n,xIsNext:n%2===0,isWin:!1,winner:null}),e.next=4,t.emit("retrieve_chess",r);case 4:p(Object(j.a)(Object(j.a)({},v),r));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(u.a.mark((function e(n,r){var o,a,i,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("stepNum-click: ".concat(v.stepNum)),o=v.history.slice(0,v.stepNum+1),a=o[o.length-1],i=JSON.parse(JSON.stringify(a.square)),!0!==k(i,n,r)&&!i[n][r]){e.next=6;break}return e.abrupt("return");case 6:return i[n][r]=v.xIsNext?"X":"O",s=Object(j.a)(Object(j.a)({},v),{},{stepNum:o.length,xIsNext:!v.xIsNext,history:o.concat([{square:i}]),curX:n,curY:r,room:c}),e.next=10,t.emit("set_chess",s);case 10:p(Object(j.a)(Object(j.a)({},v),s));case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(e,n,r){if(!0===v.isWin)return!0;var c=v.xIsNext?"X":"O";if(h(e,n,r,c)){var o=v.history.slice(0,v.stepNum+1);e[n][r]=c;var a=Object(j.a)(Object(j.a)({},v),{},{isWin:!0,winner:c,stepNum:o.length,xIsNext:!v.xIsNext,history:o.concat([{square:e}]),curX:n,curY:r});return t.emit("win_chess",a),p(Object(j.a)(Object(j.a)({},v),a)),!0}return!1},y=v.history,g=y[v.stepNum],w=y.map((function(e,t){var n=t?"Go to move #".concat(t):"Go to game start";return Object(f.jsx)("li",{children:Object(f.jsx)("button",{onClick:function(){d(t)},children:n})},t)}));return Object(f.jsxs)("div",{className:"game",children:[Object(f.jsx)("div",{className:"game-board",children:Object(f.jsx)(O,{square:g.square,onClick:function(e,t){return N(e,t)},len:15})}),Object(f.jsxs)("div",{className:"game-info",children:[Object(f.jsxs)("div",{children:["Username:",n]}),Object(f.jsxs)("div",{children:["ChessRoom:",c]}),Object(f.jsx)("div",{children:function(e){var t=v.winner;return t?"Winner is ".concat(t):"Next player: ".concat(v.xIsNext?"X":"O")}()}),Object(f.jsx)("div",{children:"---Location: \n row:".concat(v.curX," \n col:").concat(v.curY,"----")}),Object(f.jsx)("button",{onClick:function(){s((function(){return!1}));var e={username:n,room:c};t.emit("leave",e)},children:"Log out"}),Object(f.jsx)("ol",{children:w})]})]})},v=n(28),p=Object(v.a)("https://tic-socket.herokuapp.com/");var d=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1],o=Object(r.useState)(""),a=Object(i.a)(o,2),s=a[0],u=a[1],l=Object(r.useState)(!1),j=Object(i.a)(l,2),b=j[0],O=j[1],h=function(){""!==n&&""!==s&&(p.emit("join_room",{user:n,room:s}),p.on("full",(function(e){if(e)return O(!1),void alert("the room is full")})),O(!0))};return Object(f.jsx)("div",{className:"App",children:Object(f.jsx)(x.Provider,{value:[b,O],children:b?Object(f.jsx)(m,{socket:p,username:n,room:s}):Object(f.jsxs)("div",{className:"joinChatContainer",children:[Object(f.jsx)("h3",{children:"Join a Chess"}),Object(f.jsx)("input",{type:"text",placeholder:"John",onChange:function(e){c(e.target.value)}}),Object(f.jsx)("input",{type:"text",placeholder:"Room ID",onChange:function(e){u(e.target.value)},onKeyUp:function(e){13===e.keyCode&&h()}}),Object(f.jsx)("button",{onClick:h,children:"Join a room"})]})})})};a.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(d,{})}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.5aa6ba3f.chunk.js.map